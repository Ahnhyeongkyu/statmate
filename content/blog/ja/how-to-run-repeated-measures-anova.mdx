---
title: "反復測定分散分析の実行方法 — ステップバイステップガイド"
description: "反復測定分散分析の完全な解説。球面性の検定から事後ペアワイズ比較まで、例示データ、計算、解釈のガイダンスを含みます。"
date: "2026-02-20"
category: "使い方ガイド"
tags:
  - 反復測定分散分析
  - 被験者内デザイン
  - 球面性
  - Mauchly検定
  - Greenhouse-Geisser
  - 事後検定
  - 縦断分析
---

## はじめに

反復測定分散分析は、**同じ参加者**が複数の条件または複数の時点で測定される場合に平均値を比較する統計手法です。一元配置分散分析の被験者内版であり、臨床試験、心理学実験、被験者が自身の対照となる縦断研究で一般的に使用されます。

反復測定デザインの主な利点は**統計的検出力の向上**です。各参加者がすべての条件に出現するため、個人差が制御され、誤差分散が減少します。しかし、このデザインは**球面性**と呼ばれる独自の仮定を導入し、検定して、違反した場合は修正する必要があります。

本ガイドでは、データのセットアップから事後比較の解釈まですべてをカバーします。ご自身の反復測定データを分析したい場合は、[反復測定分散分析計算機](/calculators/repeated-measures-anova)をお試しください。

## 反復測定分散分析を使用する場面

反復測定分散分析は以下の場合に使用します：

- 3つ以上のレベル（条件または時点）を持つ**被験者内要因が1つ**ある。
- **従属変数が連続型**（間隔尺度または比率尺度）である。
- **同じ参加者**が各レベルで測定されている。

一般的な例：

- 3つの異なる薬物用量での反応時間を測定する（被験者内）。
- 介入前のベースライン、3か月後、6か月後の認知パフォーマンスを検定する。
- 治療前、治療直後、フォローアップ時の痛み評定を比較する。

2つの時点しかない場合は、**対応のあるt検定**の方がシンプルで同等の結果を得られます。被験者内要因と被験者間要因の両方がある場合は、**混合分散分析**が必要です。

## 主要な仮定

### 1. 連続型従属変数

アウトカムは連続尺度（間隔または比率）で測定される必要があります。

### 2. 関連のあるグループ

各レベルの観測値は、同じ参加者またはマッチングされた参加者からのものでなければなりません。

### 3. 有意な外れ値がないこと

いずれかの条件における極端な値はF検定を歪める可能性があります。箱ひげ図またはスチューデント化残差（プラスマイナス3を超える値は問題）で外れ値を確認してください。

### 4. おおよその正規性

従属変数は各レベルでおおよそ正規分布している必要があります。サンプルサイズが25-30以上であれば、中心極限定理により、F検定は中程度の非正規性に対して頑健です。サンプルが小さい場合はShapiro-Wilk検定を使用してください。

### 5. 球面性

これは反復測定分散分析に固有の重要な仮定です。球面性は、すべての条件ペア間の**差の分散が等しい**ことを要求します。球面性が侵害されると、F検定は自由すぎ（第一種の過誤率が膨張し）ます。

**Mauchlyの検定**で球面性を検定します。有意（p < 0.05）であれば、球面性が侵害されており、修正が必要です。

## データセットの例

研究者が、12人の参加者の不安スコア（0-50スケール）を3つの時点で測定します：セラピー前（T1）、4週間のセラピー後（T2）、8週間のセラピー後（T3）。

| 参加者 | T1（ベースライン） | T2（4週間） | T3（8週間） |
|--------|-------------------|------------|------------|
| 1      | 38                | 30         | 22         |
| 2      | 42                | 35         | 28         |
| 3      | 35                | 28         | 20         |
| 4      | 40                | 33         | 25         |
| 5      | 45                | 38         | 30         |
| 6      | 37                | 31         | 24         |
| 7      | 33                | 27         | 21         |
| 8      | 41                | 34         | 26         |
| 9      | 39                | 32         | 23         |
| 10     | 44                | 36         | 29         |
| 11     | 36                | 29         | 19         |
| 12     | 43                | 37         | 31         |

### 記述統計量

| 時点            | 平均  | SD   | n  |
|----------------|-------|------|----|
| T1（ベースライン）| 39.42 | 3.63 | 12 |
| T2（4週間）     | 32.50 | 3.50 | 12 |
| T3（8週間）     | 24.83 | 3.93 | 12 |

平均値は明確な下降傾向を示しています：不安はセラピーの経過とともに39.42から32.50、そして24.83へと減少しています。

## ステップ1：外れ値の確認

各時点の箱ひげ図を作成し、四分位数から1.5 IQRを超える値がないか確認します。本データセットでは、すべての値が想定範囲内に収まっています。外れ値は検出されませんでした。

## ステップ2：正規性の検定

各時点でShapiro-Wilk検定を適用します：

| 時点 | Shapiro-Wilk W | p値    |
|------|----------------|--------|
| T1   | 0.953          | 0.682  |
| T2   | 0.961          | 0.754  |
| T3   | 0.948          | 0.618  |

すべてのp値が0.05を超えているため、いずれの時点でも正規性の帰無仮説を棄却しません。仮定は満たされています。

## ステップ3：球面性の検定（Mauchlyの検定）

Mauchlyの検定は、すべての条件ペア間の差の分散が等しいかどうかを評価します。

| Mauchly W | カイ二乗 | 自由度 | p値    |
|-----------|---------|--------|--------|
| 0.814     | 2.087   | 2      | 0.352  |

p値は0.352であり、0.05を超えています。球面性は**侵害されていません**。標準の（未修正の）F検定で進めることができます。

**球面性が侵害された場合は？** 以下の修正のいずれかを使用します：

| 修正               | イプシロン | 使用する場面                        |
|-------------------|----------|-------------------------------------|
| Greenhouse-Geisser | 0.871    | イプシロン < 0.75またはサンプルが小さい |
| Huynh-Feldt        | 0.942    | イプシロン >= 0.75                    |

イプシロン値は自由度を下方修正し、F検定をより保守的にします。イプシロン = 1.0の場合、球面性は完全に満たされています。

## ステップ4：反復測定分散分析の実行

### 変動の分割

反復測定分散分析では、全変動は以下に分割されます：

- **被験者間（SS_subjects）：** 個人差による変動。
- **被験者内効果（SS_time）：** 実験操作（時間）による変動。
- **被験者内誤差（SS_error）：** 時間や被験者で説明されない残差変動。

### 計算

全体平均 = (39.42 + 32.50 + 24.83) / 3 = 32.25

**SS_time**（時間の効果）：

SS_time = n x [(M_T1 - GM)^2 + (M_T2 - GM)^2 + (M_T3 - GM)^2]

SS_time = 12 x [(39.42 - 32.25)^2 + (32.50 - 32.25)^2 + (24.83 - 32.25)^2]

SS_time = 12 x [51.41 + 0.0625 + 55.04] = 12 x 106.51 = 1278.12

**自由度：**

- df_time = k - 1 = 3 - 1 = 2
- df_error = (k - 1)(n - 1) = 2 x 11 = 22

残差からSS_error = 62.55を計算した後：

### 分散分析表

| ソース       | SS       | 自由度 | MS      | F       | p値      | 偏イータ二乗 |
|-------------|----------|--------|---------|---------|----------|-------------|
| 時間         | 1278.12  | 2      | 639.06  | 224.80  | < 0.001  | 0.953       |
| 誤差（時間） | 62.55    | 22     | 2.843   |         |          |             |
| 被験者       | 143.22   | 11     | 13.02   |         |          |             |

**結果：** F(2, 22) = 224.80, p < .001, 偏イータ二乗 = 0.953。

時間の効果は高度に有意です。偏イータ二乗0.953は、不安スコアの被験者内分散の95.3%が時間要因によって説明されることを示しています。非常に大きな効果です。

### 効果量のガイドライン（偏イータ二乗）

| 効果量 | 偏イータ二乗 |
|--------|-------------|
| 小     | 0.01        |
| 中     | 0.06        |
| 大     | 0.14        |

0.953という値は、大きな効果の閾値をはるかに超えています。

## ステップ5：事後ペアワイズ比較

有意なF検定は、少なくとも1つの時点ペアが異なることを示しますが、どのペアかは示しません。ボンフェローニ修正（アルファ = 0.05 / 3 = 0.0167）でペアワイズ比較を実行します。

| 比較       | 平均差  | SE    | t       | 自由度 | p（ボンフェローニ） | 95% CI          |
|-----------|---------|-------|---------|--------|-------------------|-----------------|
| T1 vs T2  | 6.92    | 0.53  | 13.06   | 11     | < 0.001           | [5.76, 8.08]    |
| T1 vs T3  | 14.58   | 0.72  | 20.25   | 11     | < 0.001           | [13.00, 16.17]  |
| T2 vs T3  | 7.67    | 0.56  | 13.70   | 11     | < 0.001           | [6.44, 8.90]    |

ボンフェローニ修正後、3つのペアワイズ比較すべてが有意です。不安スコアは、ベースラインから4週間、4週間から8週間、ベースラインから8週間のすべてで有意に減少しました。

## ステップ6：結果の報告

> 不安スコアをベースライン（M = 39.42, SD = 3.63）、4週間（M = 32.50, SD = 3.50）、8週間（M = 24.83, SD = 3.93）で比較するために、一元反復測定分散分析を実施した。Mauchlyの検定は球面性の仮定が満たされていることを示した（W = 0.814, p = .352）。時間の効果は統計的に有意であった（F(2, 22) = 224.80, p < .001, 偏イータ二乗 = .953）。ボンフェローニ修正による事後ペアワイズ比較では、すべての時点間で有意な不安の減少が示された（すべてのp値 < .001）。不安はベースラインから4週間で6.92点（95% CI [5.76, 8.08]）、4週間から8週間でさらに7.67点（95% CI [6.44, 8.90]）減少した。

## 球面性の侵害への対処

Mauchlyの検定が有意な場合、いくつかの選択肢があります：

### 選択肢1：Greenhouse-Geisser修正

自由度にイプシロンを掛けます。イプシロン = 0.72の場合：

- 修正df_time = 2 x 0.72 = 1.44
- 修正df_error = 22 x 0.72 = 15.84

F(1.44, 15.84)として報告し、ソフトウェアからの修正p値を使用します。

### 選択肢2：Huynh-Feldt修正

Greenhouse-Geisserよりも保守的でありません。Greenhouse-Geisserのイプシロンが0.75を超える場合に使用します。

### 選択肢3：多変量アプローチ（MANOVA）

差スコアに対して多変量検定（PillaiのトレースやWilksのラムダ）を実行します。多変量アプローチは球面性を仮定しませんが、より大きなサンプルサイズを必要とします。

| アプローチ         | 使用する場面                      | 長所                    | 短所                   |
|-------------------|----------------------------------|------------------------|------------------------|
| 修正なし          | 球面性が満たされる（Mauchly p > .05） | 最も検出力が高い        | 誤りの場合誤差膨張     |
| Greenhouse-Geisser | イプシロン < 0.75                 | 保守的で安全            | 保守的すぎることがある |
| Huynh-Feldt       | イプシロン >= 0.75                | バランスの取れた修正    | あまり知られていない   |
| MANOVA            | 重度の侵害、大きなN              | 球面性の仮定不要        | より大きなNが必要      |

## よくある間違いの回避

1. **球面性の検定を忘れる。** F統計量を解釈する前に、必ずMauchlyの検定を実行してください。

2. **反復測定ではなく一元配置分散分析を使用する。** 同じ被験者がすべての条件に出現する場合、被験者内相関を考慮するために反復測定を使用しなければなりません。

3. **多重比較の修正をしない。** ボンフェローニまたは類似の修正なしでは、事後検定は実験全体の第一種の過誤率を膨張させます。

4. **欠損データを無視する。** 標準的な反復測定分散分析は完全ケースを必要とします。参加者に欠損観測値がある場合は、混合効果モデルまたは代入を検討してください。

5. **非有意なFを「効果なし」と解釈する。** 非有意な結果は帰無仮説を証明するものではありません。サンプルサイズと検出力を考慮してください。

## ご自身で試してみましょう

反復測定データを[反復測定分散分析計算機](/calculators/repeated-measures-anova)にアップロードして、球面性検定、効果量、事後比較を含む即時分析を行いましょう。

2つの時点のみの比較には、[対応のあるt検定計算機](/calculators/paired-t-test)をご覧ください。被験者内要因と被験者間要因の両方を含むデザインには、[混合分散分析計算機](/calculators/mixed-anova)をご覧ください。

## よくある質問

### 反復測定分散分析に必要な参加者数は？

中程度の効果を検出するための十分な検出力を得るには、少なくとも20人の参加者が一般的に推奨されます。期待される効果量、希望する検出力（通常0.80）、アルファ水準（0.05）を用いて事前検出力分析を実施してください。反復測定デザインは誤差分散を減少させるため、通常、被験者間デザインよりも少ない参加者で済みます。

### 2つの時点で反復測定分散分析を使用できますか？

技術的にはできますが、**対応のあるt検定**の方がシンプルで同一の結果を得られます。反復測定分散分析は3つ以上のレベル向けに設計されています。2レベルでは球面性は自動的に満たされ、F統計量はt統計量の二乗に等しくなります。

### 反復測定分散分析と混合分散分析の違いは？

反復測定分散分析は被験者内要因のみを持ちます。**混合分散分析**（分割プロットANOVAとも呼ばれる）は、少なくとも1つの被験者内要因と少なくとも1つの被験者間要因を持ちます。例えば、3つの時点（被験者内）で2つの治療群（被験者間）にわたって不安を測定する場合です。

### 脱落や欠損データにどう対処しますか？

標準的な反復測定分散分析はリストワイズ削除を使用し、いずれかの時点で欠損データがある参加者を除外します。これはデータを無駄にし、バイアスを導入する可能性があります。**線形混合効果モデル**（マルチレベルモデルとも呼ばれる）は、ランダム欠損（MAR）の仮定のもとで欠損データをより適切に扱います。欠損データが5-10%を超える場合は、混合モデルの使用を検討してください。

### データが正規性に反する場合は？

従属変数が正規分布しておらず、サンプルサイズが小さい場合は、反復測定分散分析のノンパラメトリック代替法である**フリードマン検定**を検討してください。フリードマン検定は各参加者内でデータを順位付けし、正規性を仮定しません。ただし、パラメトリック検定よりも検出力が低くなります。

### 反復測定分散分析に共変量を含めることはできますか？

はい。連続共変量を追加すると**反復測定共分散分析**になります。共変量が時変の場合は各時点で測定される必要があり、時不変（例：ベースライン年齢）の場合は1回の測定で十分です。ほとんどの統計ソフトウェアパッケージがこの拡張をサポートしています。

### 反復測定分散分析に適切な事後検定は？

最も一般的な選択肢は：

- **ボンフェローニ修正：** アルファを比較数で割ります。保守的ですがシンプル。
- **Sidak修正：** ボンフェローニよりわずかに保守的でない。
- **TukeyのHSD：** 反復測定に適応、実験全体の過誤率を制御。
- **最小有意差（LSD）：** 修正なし；全体のF検定が有意でかつ3群の場合のみ適切。
