---
title: "カイ二乗独立性検定の実行方法 — ステップバイステップガイド"
description: "カイ二乗独立性検定をステップごとに実行する方法を解説します。分割表の作成、期待度数の計算、結果の解釈、仮定の確認までを網羅しています。"
date: "2026-02-20"
category: "使い方ガイド"
tags:
  - カイ二乗検定
  - 独立性検定
  - 分割表
  - カテゴリカルデータ
  - クロス集計
  - Cramer's V
  - ステップバイステップガイド
---

## はじめに

カイ二乗独立性検定は、2つのカテゴリカル変数の間に統計的に有意な関連があるかどうかを判断するために使用されます。連続変数の平均値を比較するt検定やANOVAとは異なり、カイ二乗検定は分割表にまとめられた度数データ（カウントデータ）を扱います。

この検定は、社会科学研究、市場調査、医学研究、品質管理において頻繁に使用されます。「性別と製品の好みに関連はあるか？」や「治療の種類は回復状態に影響するか？」といった疑問を持ったことがあるなら、カイ二乗独立性検定がまさに必要な分析です。

このガイドでは、分割表の設定から結果の解釈まで、具体的な計算例を用いてすべてのステップを解説します。

## カイ二乗独立性検定を使用すべき場面

この検定は以下の場合に使用します：

- **2つのカテゴリカル変数**（名義尺度または順序尺度）がある場合。
- 変数が**独立**か**関連**しているかを検定したい場合。
- データが平均値や連続測定値ではなく、**度数（頻度）**で構成されている場合。
- 各観測が分割表の1つのセルにのみ該当する場合。

カテゴリカル変数と連続変数の結果を比較する場合は、t検定やANOVAを検討してください。

## ステップ1：仮説を立てる

**例題シナリオ：** ある大学の研究者が、学習方法（オンライン、図書館、スタディグループ）と試験結果（合格、不合格）の間に関連があるかどうかを、200名の学生について調査したいと考えています。

- **H0（帰無仮説）：** 学習方法と試験結果は独立である。2つの変数の間に関連はない。
- **H1（対立仮説）：** 学習方法と試験結果は独立ではない。2つの変数の間に関連がある。

## ステップ2：データを分割表にまとめる

度数カウントを収集し、分割表（クロス集計表とも呼ばれる）に整理します：

| | 合格 | 不合格 | 行合計 |
|---|------|--------|--------|
| **オンライン** | 42 | 28 | 70 |
| **図書館** | 51 | 14 | 65 |
| **スタディグループ** | 48 | 17 | 65 |
| **列合計** | 141 | 59 | 200 |

各セルには、学習方法と試験結果の組み合わせに該当する学生の数が含まれています。

## ステップ3：期待度数を計算する

帰無仮説（独立性）のもとで、各セルの期待度数は以下のように求められます：

**期待度数 = (行合計 * 列合計) / 総数**

| | 合格（期待度数） | 不合格（期待度数） |
|---|------------------|-------------------|
| **オンライン** | (70 * 141) / 200 = 49.35 | (70 * 59) / 200 = 20.65 |
| **図書館** | (65 * 141) / 200 = 45.83 | (65 * 59) / 200 = 19.18 |
| **スタディグループ** | (65 * 141) / 200 = 45.83 | (65 * 59) / 200 = 19.18 |

## ステップ4：仮定を確認する

計算に進む前に、以下の仮定を確認してください：

### 1. 観測の独立性

各学生は1回のみカウントされ、1つのセルにのみ該当します。この研究では、同時に複数の学習方法を使用した学生はいません。

### 2. 期待度数のルール

カイ二乗近似は、**期待度数が5未満のセルが全体の20%を超えない**、かつ**期待度数が1未満のセルがない**場合に有効です。期待度数を確認すると：

- 最小の期待度数：19.18

すべての期待度数が5を大きく上回っているため、この仮定は満たされています。非常に小さな期待度数がある場合は、Fisher正確確率検定の使用を検討してください。

### 3. 標本サイズ

一般的なガイドラインとして、総標本サイズはセル数の少なくとも5倍であるべきです。6セルでN = 200なので、この条件は十分に満たされています。

## ステップ5：カイ二乗統計量を計算する

カイ二乗統計量は以下のように計算されます：

**カイ二乗 = (観測度数 - 期待度数)^2 / 期待度数 の合計**

各セルについて計算します：

| セル | 観測度数（O） | 期待度数（E） | (O - E)^2 / E |
|------|-------------|-------------|----------------|
| オンライン、合格 | 42 | 49.35 | (42 - 49.35)^2 / 49.35 = 1.095 |
| オンライン、不合格 | 28 | 20.65 | (28 - 20.65)^2 / 20.65 = 2.615 |
| 図書館、合格 | 51 | 45.83 | (51 - 45.83)^2 / 45.83 = 0.583 |
| 図書館、不合格 | 14 | 19.18 | (14 - 19.18)^2 / 19.18 = 1.398 |
| スタディグループ、合格 | 48 | 45.83 | (48 - 45.83)^2 / 45.83 = 0.103 |
| スタディグループ、不合格 | 17 | 19.18 | (17 - 19.18)^2 / 19.18 = 0.248 |

**カイ二乗 = 1.095 + 2.615 + 0.583 + 1.398 + 0.103 + 0.248 = 6.042**

## ステップ6：自由度を求める

**df = (行数 - 1) * (列数 - 1)**

df = (3 - 1) * (2 - 1) = 2 * 1 = **2**

## ステップ7：p値を求める

カイ二乗 = 6.042、df = 2の場合、p値は約 **.049** です。

p = .049 < .05であるため、有意水準.05で帰無仮説を棄却します。学習方法と試験結果の間に統計的に有意な関連があることが示されました。

## ステップ8：効果量を計算する

カイ二乗検定では、**Cramerの V** が標準的な効果量指標です：

**V = sqrt(カイ二乗 / (N * min(r-1, c-1)))**

V = sqrt(6.042 / (200 * 1)) = sqrt(0.0302) = **0.174**

Cramerの V の解釈ガイドライン：

| df* | 小 | 中 | 大 |
|-----|------|--------|-------|
| 1 | 0.10 | 0.30 | 0.50 |
| 2 | 0.07 | 0.21 | 0.35 |
| 3 | 0.06 | 0.17 | 0.29 |

*df* はmin(r-1, c-1)を指します。df* = 1の場合、V = 0.174は小から中程度の効果を示しています。

## ステップ9：パターンを検討する

関連の性質を理解するために、観測値と期待値を比較するか、列パーセンテージを確認します：

| | 合格率（%） |
|---|------------|
| オンライン | 42/70 = 60.0% |
| 図書館 | 51/65 = 78.5% |
| スタディグループ | 48/65 = 73.8% |

図書館グループが最も高い合格率（78.5%）を示し、次いでスタディグループ（73.8%）、オンライン（60.0%）の順でした。有意なカイ二乗の結果は、主にオンライングループの低い合格率によって駆動されているようです。

## ステップ10：結果を報告する

学習方法と試験結果の関連を検討するためにカイ二乗独立性検定を実施しました。分析の結果、統計的に有意な関連が認められました。カイ二乗(2, N = 200) = 6.04, *p* = .049, *V* = .17。図書館で学習した学生の合格率が最も高く（78.5%）、次いでスタディグループ（73.8%）、オンライン学習（60.0%）の順でした。

## 2x2分割表：特殊なケース

2x2の分割表では手順は同じですが、追加の選択肢があります：

- **イエーツの連続補正**：2x2分割表に対してカイ二乗検定をより保守的にするための小さな補正です。
- **Fisher正確確率検定**：期待度数が5未満のセルがある場合に推奨されます。
- **オッズ比**：2x2分割表に特有の有用な効果量指標です。

## よくある間違いと注意点

1. **度数の代わりにパーセンテージを使用する**：カイ二乗検定には生の度数データが必要であり、パーセンテージや比率ではありません。分析前に度数に変換してください。

2. **独立性の仮定の違反**：各観測は独立でなければなりません。同じ人が複数のセルに該当する可能性がある場合（例：反復測定）、カイ二乗検定は不適切です。

3. **小さな期待度数の無視**：期待度数が5未満のセルが全体の20%を超える場合、カイ二乗近似は信頼性が低くなります。そのような場合はFisher正確確率検定を使用してください。

4. **統計的有意性と実質的有意性の混同**：小さなCramerの V で有意なカイ二乗が得られても、実質的な意味がない場合があります。常に効果量を報告してください。

5. **方向性の過大解釈**：カイ二乗検定は関連の存在を示しますが、因果関係を示すものではありません。学習方法と試験結果の両方が、測定されていない変数の影響を受けている可能性があります。

## よくある質問

### カイ二乗適合度検定と独立性検定の違いは何ですか？

適合度検定は、1つの変数の観測度数を期待度数と比較します（例：サイコロが公正かどうかの検定）。独立性検定は、2つのカテゴリカル変数の間の関連を調べます。このガイドは独立性検定に焦点を当てています。

### カイ二乗検定は順序変数に使用できますか？

はい。ただし、カイ二乗検定はすべてのカテゴリーを名義尺度として扱い、順序を無視します。順序の性質を考慮したい場合は、Mantel-Haenszel傾向検定やSpearmanの順位相関を検討してください。

### 必要な標本サイズはどれくらいですか？

一般的な経験則として、各セルに少なくとも5の期待観測数が必要です。3x2の分割表では、少なくとも30の総観測数が必要です。大きな標本はより高い統計的検出力を提供します。

### 3つ以上の変数がある場合はどうすればよいですか？

3つ以上のカテゴリカル変数の場合は、対数線形分析を使用するか、個別にカイ二乗検定を実行できます。ただし、複数の検定を実行すると第1種の過誤のリスクが増加するため、Bonferroni補正などを適用してください。

### 連続データにカイ二乗検定を使用できますか？

直接的には使用できません。まず連続変数をグループに分類する必要があります（例：低/中/高）。しかし、連続変数のカテゴリ化は情報の損失を伴うため、連続データ用に設計された相関分析や回帰分析の使用を検討してください。

## StatMateでカイ二乗検定を実行する

StatMateの[カイ二乗計算機](/calculators/chi-square)を使えば、この手順を簡単に実行できます。分割表のデータを入力すると、StatMateがカイ二乗統計量、自由度、p値、Cramerの V、期待度数、標準化残差を自動的に計算します。2x2の分割表の場合は、イエーツの補正とFisher正確確率検定の結果も提供されます。
