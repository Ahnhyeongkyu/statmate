---
title: "一元配置分散分析（ANOVA）の実行方法 — ステップバイステップガイド（事後検定付き）"
description: "一元配置分散分析を実行するための完全なステップバイステップガイドです。仮定の確認からTukeyの事後検定の実行まで、実データを使った計算例を含めて解説します。"
date: "2026-02-20"
category: "使い方ガイド"
tags:
  - 分散分析
  - ANOVA
  - 一元配置分散分析
  - 事後検定
  - Tukey HSD
  - 仮説検定
  - F検定
  - ステップバイステップガイド
---

## はじめに

分散分析（ANOVA）は、3つ以上のグループ間で平均値を比較する必要がある場合に使用される統計手法です。t検定が2つのグループを扱うのに対し、ANOVAは複数のt検定を実行した場合に生じる第1種の過誤率の膨張を防ぎながら、任意の数のグループに比較を拡張します。

このガイドでは、一元配置ANOVAの実行に必要なすべてのステップを解説します：仮説の設定、仮定の確認、分析の実行、F統計量の解釈、そしてどのグループ間に差があるかを特定する事後検定の実行について説明します。実際の数値を用いた計算例を含めていますので、最初から最後まで手順を追って学習できます。

## 一元配置ANOVAを使用すべき場面

一元配置ANOVAは以下の条件で使用します：

- **1つの独立変数**（要因）に**3つ以上の水準**（グループ）がある場合。
- **従属変数が連続変数**（間隔尺度または比率尺度）である場合。
- グループの平均値がすべて等しいか、少なくとも1つが異なるかを検定したい場合。

2つのグループしかない場合は、[t検定](/calculators/t-test)で十分です。2つ以上の独立変数がある場合は、二元配置ANOVAを検討してください。

## ステップ1：仮説を立てる

**例題シナリオ：** ある栄養士が、3つの食事プラン（低炭水化物、地中海式、断続的断食）の12週間にわたる体重減少効果を比較したいと考えています。

- **H0（帰無仮説）：** 3つの食事グループ間で平均体重減少量は等しい。（mu1 = mu2 = mu3）
- **H1（対立仮説）：** 少なくとも1つのグループの平均値が他と異なる。

ANOVAは差が存在するかどうかを検定するものであり、どのグループ間で差があるかは教えてくれないことに注意してください。そのため事後検定が必要になります。

## ステップ2：データを収集し整理する

各食事グループの12週間後の体重減少量（kg）：

| 低炭水化物 | 地中海式 | 断続的断食 |
|-----------|---------|-----------|
| 5.2 | 4.8 | 7.1 |
| 6.1 | 5.5 | 6.8 |
| 4.8 | 3.9 | 8.2 |
| 5.9 | 4.2 | 7.5 |
| 5.5 | 5.1 | 6.9 |
| 6.3 | 4.6 | 7.8 |
| 5.0 | 3.7 | 8.0 |
| 5.7 | 5.3 | 7.3 |

各グループの参加者数はn = 8、合計N = 24です。

## ステップ3：記述統計量を計算する

| グループ | n | 平均値（*M*） | SD |
|---------|---|-------------|------|
| 低炭水化物 | 8 | 5.56 | 0.53 |
| 地中海式 | 8 | 4.64 | 0.65 |
| 断続的断食 | 8 | 7.45 | 0.50 |

全体平均 = (5.56 + 4.64 + 7.45) / 3 = 5.88

## ステップ4：仮定を確認する

一元配置ANOVAには3つの仮定が必要です：

### 1. 観測の独立性

各参加者は1つのグループにのみ属し、測定値が互いに影響を及ぼさないこと。これは適切な研究デザインによって確保されます。

### 2. 正規性

各グループ内で従属変数がほぼ正規分布に従うこと。以下の方法で確認できます：

- **Shapiro-Wilk検定**：有意でない結果（p > .05）は、データが正規分布と整合していることを示唆します。
- **視覚的検査**：Q-Qプロットやヒストグラムにより、正規性からの明らかな逸脱を検出できます。

ANOVAは、特にグループサイズが等しい場合、正規性の軽微な違反に対しては比較的頑健です。

### 3. 等分散性

各グループの分散がほぼ等しいこと。**Levene検定**を使用して確認します：

- Levene検定が有意でない場合（p > .05）、等分散の仮定は満たされています。
- 有意な場合は、等分散を仮定しないWelchのANOVAの使用を検討してください。

この例では、SDは0.50から0.65の範囲にあり、十分に類似しています。

## ステップ5：ANOVA表を計算する

ANOVAの核心は、全分散をグループ間分散とグループ内分散に分割することです。

### グループ間平方和（SSB）

SSB = ni * (Mi - 全体平均)^2 の合計

- 低炭水化物：8 * (5.56 - 5.88)^2 = 8 * 0.1024 = 0.819
- 地中海式：8 * (4.64 - 5.88)^2 = 8 * 1.5376 = 12.301
- 断続的断食：8 * (7.45 - 5.88)^2 = 8 * 2.4649 = 19.719

**SSB = 0.819 + 12.301 + 19.719 = 32.839**

### グループ内平方和（SSW）

SSW = (ni - 1) * SDi^2 の合計

- 低炭水化物：7 * 0.281 = 1.967
- 地中海式：7 * 0.423 = 2.958
- 断続的断食：7 * 0.250 = 1.750

**SSW = 1.967 + 2.958 + 1.750 = 6.675**

### 自由度

- df_between = k - 1 = 3 - 1 = 2
- df_within = N - k = 24 - 3 = 21

### 平均平方

- MSB = SSB / df_between = 32.839 / 2 = 16.420
- MSW = SSW / df_within = 6.675 / 21 = 0.318

### F統計量

**F = MSB / MSW = 16.420 / 0.318 = 51.64**

### 完全なANOVA表

| 変動因 | SS | df | MS | F | p |
|--------|-------|----|----|-------|-------|
| グループ間 | 32.839 | 2 | 16.420 | 51.64 | < .001 |
| グループ内 | 6.675 | 21 | 0.318 | | |
| 合計 | 39.514 | 23 | | | |

## ステップ6：統計的有意性を判断する

F(2, 21) = 51.64で、p値は.001未満です。p < .05であるため、帰無仮説を棄却します。少なくとも1つの食事グループは、平均体重減少量において他のグループと有意に異なっています。

## ステップ7：効果量を計算する

**イータ二乗**は、グループ変数によって説明される全分散の割合を測定します：

イータ二乗 = SSB / SST = 32.839 / 39.514 = **0.831**

これは、体重減少量の分散の83.1%が食事の種類によって説明されることを意味します。非常に大きな効果です。

**オメガ二乗**はより偏りの少ない推定値を提供します：

オメガ二乗 = (SSB - df_between * MSW) / (SST + MSW) = (32.839 - 2 * 0.318) / (39.514 + 0.318) = 32.203 / 39.832 = **0.809**

## ステップ8：事後検定を実行する

ANOVAが有意であったため、どのグループ対間に差があるかを特定するために事後検定が必要です。TukeyのHSD（Honestly Significant Difference）検定が最も一般的に使用されます。

### Tukey HSD検定の結果

| 比較 | 平均差 | p（調整済み） | 有意？ |
|------|--------|--------------|--------|
| 低炭水化物 vs. 地中海式 | 0.92 | .004 | はい |
| 低炭水化物 vs. 断続的断食 | -1.89 | < .001 | はい |
| 地中海式 vs. 断続的断食 | -2.81 | < .001 | はい |

3つの対比較すべてが統計的に有意でした。断続的断食が最も大きな体重減少を示し、次いで低炭水化物、そして地中海式の順でした。

## ステップ9：結果を解釈し報告する

3つの食事プランにおける体重減少を比較するために一元配置ANOVAを実施しました。グループ間に統計的に有意な差が認められました。*F*(2, 21) = 51.64, *p* < .001, イータ二乗 = .83。Tukey HSD事後検定の結果、断続的断食グループ（*M* = 7.45, *SD* = 0.50）は低炭水化物グループ（*M* = 5.56, *SD* = 0.53, *p* < .001）および地中海式グループ（*M* = 4.64, *SD* = 0.65, *p* < .001）の両方より有意に多く体重が減少していました。低炭水化物グループも地中海式グループより有意に体重が減少していました（*p* = .004）。

## 仮定が満たされない場合の代替手法

| 違反された仮定 | 代替検定 |
|---------------|---------|
| 正規性 | Kruskal-Wallis H検定（ノンパラメトリック） |
| 等分散性 | WelchのANOVA |
| 正規性と等分散性の両方 | Kruskal-Wallis H検定 |

## よくある間違いと注意点

1. **ANOVAの代わりに複数のt検定を実行する**：3グループを3回の個別t検定で比較すると、第1種の過誤率が5%から約14%に膨張します。ANOVAはこれを制御します。

2. **F検定の段階で止まる**：有意なF統計量は、何らかの差が存在することしか教えてくれません。どのグループ間に差があるかを特定するために、必ず事後検定でフォローアップしてください。

3. **効果量の無視**：小さな効果量で有意なF検定の結果が得られても、実質的な意味がない場合があります。常にイータ二乗またはオメガ二乗を報告してください。

4. **仮定の確認を怠る**：特に等分散性の確認は重要です。不等分散はF統計量を歪め、誤った結論につながる可能性があります。

5. **有意でない結果の誤解釈**：有意でないANOVAは、すべてのグループが等しいことを証明するものではありません。差があると結論付けるための十分な証拠がないことを意味します。

## よくある質問

### ANOVAは2グループでも使用できますか？

技術的にはできますが、結果は独立標本t検定と同一になります（F = t^2）。ただし、2グループの比較にはt検定の方が簡潔で一般的に使用されます。

### グループの標本サイズが異なる場合はどうすればよいですか？

一元配置ANOVAは不等な標本サイズでも機能しますが、等分散性の仮定の違反に対してより敏感になります。Levene検定で確認し、分散が大きく異なる場合はWelchのANOVAを検討してください。

### どの事後検定を使用すべきですか？

すべてのグループ対を比較したい場合は、Tukey HSDが最も一般的な選択肢です。グループサイズが不等の場合はGames-Howellが推奨されます。特定の計画比較がある場合は、Bonferroni補正付きt検定を使用してください。

### イータ二乗と偏イータ二乗の違いは何ですか？

一元配置ANOVAでは、両者は同一です。偏イータ二乗は、要因計画（二元配置ANOVA以上）で関連性が高く、他の要因を統制した後の1つの要因によって説明される分散の割合を表します。

### ANOVAの結果をAPA書式で報告するにはどうすればよいですか？

次のパターンに従ってください：*F*(df_between, df_within) = 値, *p* = 値, イータ二乗 = 値。例：*F*(2, 21) = 51.64, *p* < .001, イータ二乗 = .83。

## StatMateでANOVAを実行する

StatMateの[ANOVA計算機](/calculators/anova)はワークフロー全体を処理します。グループデータを入力すると、ANOVA表の計算、仮定の確認（正規性と等分散性）、効果量の算出、Tukey HSDまたはBonferroni事後検定の実行が自動で行われます。結果はAPA書式で表示され、論文にそのまま使用できます。
